<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Transformation & nettoyage</title>
    <link rel="stylesheet" href="/static/style.css">
  </head>
  <body>
    <h1>Transformation & nettoyage de texte (TP Regex)</h1>

    <form method="post">
      <label for="text">Texte source :</label><br>
      <textarea id="text" name="text" rows="8" cols="80">{{ text or '' }}</textarea>
      <br><br>

      <label for="pattern">Pattern regex :</label><br>
      <input type="text" id="pattern" name="pattern"
             value="{{ pattern or '' }}"
             placeholder="par ex. \\s+ pour les espaces multiples">
      <br><br>

      <label for="replacement">Remplacement :</label><br>
      <input type="text" id="replacement" name="replacement"
             value="{{ replacement or '' }}"
             placeholder="par ex. ' '">
      <br><br>

      <fieldset>
        <legend>Options (flags) :</legend>
        <label>
          <input type="checkbox" name="ignore_case"
                 {% if request.form.get('ignore_case') %}checked{% endif %}>
          IGNORECASE
        </label>
        <label>
          <input type="checkbox" name="multiline"
                 {% if request.form.get('multiline') %}checked{% endif %}>
          MULTILINE
        </label>
        <label>
          <input type="checkbox" name="dotall"
                 {% if request.form.get('dotall') %}checked{% endif %}>
          DOTALL
        </label>
      </fieldset>

      <br>
      <button type="submit">Transformer</button>
    </form>

    <hr>

    {% if error_message %}
      <p class="error">
        Impossible d'utiliser cette expression régulière.
        Vérifiez la syntaxe (parenthèses, crochets, accolades, antislashs).
      </p>
      <pre>{{ error_message }}</pre>
    {% endif %}

    {% if output_text is not none %}
      <h2>Résultat</h2>
      <p>Nombre de remplacements : {{ count }}</p>

      <h3>Texte transformé :</h3>
      <pre>{{ output_text }}</pre>
    {% endif %}

    <p><a href="/">Retour à l'accueil</a></p>
  </body>
</html>
